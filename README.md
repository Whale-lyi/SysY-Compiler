# Lab6实验报告

### 实验思路

1. 翻译全局变量，和局部变量的翻译类似，如果声明时没有初始化，默认初始化为0
1. 翻译 cond 节点
1. 翻译 if-else 语句，增加 ifTrue, ifFalse, next 三个基本块

### ~~精巧的~~设计

- 翻译 cond 节点时，返回值都扩展为 i32 类型。在 if 语句中将 cond 节点返回值与 0 进行比较得到结果再进行跳转
  - 可以处理 cond 比较复杂的情况

- 翻译 if-else 语句，增加 ifTrue, ifFalse, next 三个基本块，可以处理嵌套 if 的情况


### 遇到的困难及解决办法

- 没有 else 语句时也创建了 ifFalse 基本块，但是没有填内容报错
  - 应该增加一个跳转到 next 基本块的 br 指令，基本块必须要以跳转或返回结尾

- 由于 lab5 不涉及数组下标是变量的情况，直接将下标转化为了 int，在 lab6 中会报错
  - 直接将 exp 子节点的返回值保存到 indexPointer 即可

